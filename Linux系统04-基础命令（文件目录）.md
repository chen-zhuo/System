# 基础命令（文件目录）

> **说明**：本文中对Linux命令的讲解都是基于名为CentOS的Linux发行版本，我自己使用的是阿里云服务器，系统版本为CentOS  8.4 64位。不同的Linux发行版本在Shell命令和工具程序上会有一些差别，但是这些差别是很小的。

**首先我们要知道一点，Linux系统当中没有输出错误就代表执行成功。**

**其次就是，所有Linux命令的参数都可以组合使用。**

**最后确保Linux命令是在英文模式下输入，而且尽量不要使用小键盘（数字键盘）。**

## 常用命令

### 查看|切换

查看目录内容 - **ls**

- `-a`：显示全部文件（包括以点开头的隐藏文件）和目录。
- `-l`：以长格式查看文件和目录（直接输入命令 `ll` 功能一样）。
- `-R`：遇到目录要进行递归展开（继续列出目录下面的文件和目录）。
- `-d`：只列出目录，不列出其他内容。
- `-S` / `-t`：按大小/时间排序。

![QQ截图20210805003133](Image/QQ截图20210805003133.png)

以树状图列出目录下的内容 - **tree**

- `-a` 显示所有文件和目录。
- `-C` 在文件和目录清单加上色彩，便于区分各种类型。
- `-d` 只显示目录名称而非内容。
- `-D` 列出文件或目录的更改时间。
- `-f` 在每个文件或目录之前，显示完整的相对路径名称。
- `-g` 列出文件或目录的所属群组名称，没有对应的名称时，则显示群组识别码。
- `-p` 列出权限标示。
- `-s` 列出文件或目录大小。
- `-t` 用文件和目录的更改时间排序。
- `-u` 列出文件或目录的拥有者名称，没有对应的名称时，则显示用户识别码。

![QQ截图20210812010012](Image/QQ截图20210812010012.png)

切换和查看当前工作目录 - **cd** / **pwd**。

- `cd`：快速切到家目录。
- `cd /`：快速到根目录。

绝对路径：以根目录开头的全部路径，即 `/` 开头的全部路径。

相对路径：以当前路径作为参照的全部路径。

> **`cd` 命令后面可以跟相对路径或绝对路径来切换到指定的目录， 且绝对路径在任何地方都可切换，而相对路径只能在当前路径下进行切换。**

返回上层：返回上一层路径，使用 `cd ..` 命令。

当前路径：查看当前位置绝对路径，使用 `pwd` 命令。

![QQ截图20210805005828](Image/QQ截图20210805005828.png)

> 在目录切换的过程中，命令前方显示的名称也在不断变化，它显示的是当前路径的目录名称。

### 创建|删除

创建文件 - **touch**

```
touch files：在当前路径下创建空白文件files
touch program files：在当前路径下创建空白文件program和文件files
touch "program files"：在当前路径下创建文件program files（不建议文件命名包含空格）
```

![QQ截图20210821160421](Image/QQ截图20210821160421.png)

创建目录 - **mkdir**

- `-p`：当目录不存在时，自动创建目录（递归创建）。

```
mkdir tmp：创建一个名称为tmp的新文件夹
mkdir tmp/Japan：创建一个名称为Japan的新文件夹（tmp文件夹必须存在）
```

![QQ截图20210810011254](Image/QQ截图20210810011254.png)

```
# 递归创建
mkdir -p tmp1/USA：创建一个名称为USA的新文件夹（tmp1文件夹可以不存在）
```

![QQ截图20210810012301](Image/QQ截图20210810012301.png)

```
# 多目录创建
mkdir tmp/Korea tmp1/China：同时创建名为USA和China的文件夹（tmp文件夹和tmp1文件夹必须存在必须存在）
```

![QQ截图20210810012744](Image/QQ截图20210810012744.png)

```
# 递归多目录创建
mkdir -p tmp2/Union tmp3/Russia：同时创建名为Union和Russia的文件夹（tmp2文件夹和tmp3文件夹可以不存在）
```

![QQ截图20210810013407](Image/QQ截图20210810013407.png)

删除**空**目录 -  **rmdir**

- `-p`：递归删除多个空目录。

```
rmdir /tmp/Japan：删除Japan目录（只能删除空目录）
```

![QQ截图20210812010707](Image/QQ截图20210812010707.png)

如果删除的目录里面还有一层目录，不管里面这层目录是否为空目录都删除不了，并且会提示：当前目录不为空。

![QQ截图20210812011013](Image/QQ截图20210812011013.png)

```
rmdir -p tmp/Korea/：删除tmp目录（递归删除多级空目录）
```

![QQ截图20210812011909](Image/QQ截图20210812011909.png)

删除文件或目录 - **rm**

- `-f`：就是 force 的意思，忽略不存在的文件，不会出现警告信息。
- `-i`：互动模式，在删除前会询问使用者是否动作。
- `-r`：递归删除啊！最常用在目录的删除了！这是非常危险的选项！！！

![QQ截图20210821160805](Image/QQ截图20210821160805.png)

!> `rm -rf /*` 递归强制删除根目录下的所有文件，跑路命令，切勿使用！虚拟机上可以玩玩。

![QQ截图20210813010924](Image/QQ截图20210813010924.png)

### 复制|移动|重命名

复制文件或目录 - **cp**

- 不加参数直接只能复制文件。

- `-r`：复制目录。

```
cp -r tmp1/China tmp2：将tmp1目录下的China目录复制到root目录下
```

![QQ截图20210813004519](Image/QQ截图20210813004519.png)

移动文件或目录 - **mv**

- `-b`：当目标文件或目录存在时，在执行覆盖前，会为其创建一个备份。
- `-i`：如果指定移动的源目录或文件与目标的目录或文件同名，则会先询问是否覆盖旧文件，输入 y 表示直接覆盖，输入 n 表示取消该操作。
- `-f`：如果指定移动的源目录或文件与目标的目录或文件同名，不会询问，直接覆盖旧文件。
- `-n`：不要覆盖任何已存在的文件或目录。
- `-u`：当源文件比目标文件新或者目标文件不存在时，才执行移动操作。

```
mv tmp3/Russia tmp2：将tmp3目录下的Russia目录移动到tmp2目录下
```

![QQ截图20210813005350](Image/QQ截图20210813005350.png)

重命名可以直接使用 `cp` 或 `mv` 命令来完成：

```
cp -r tmp1/USA tmp3/Japan：将USA目录复制到tmp3目录下并更名为Japan
mv tmp3 tmp：在同一文件夹下将tmp3文件夹更名为tmp
```

![QQ截图20210813010009](Image/QQ截图20210813010009.png)

## 基础属性

### 文件分类

**linux系统不同类型文件会有不同的颜色**，如下图：

![QQ截图20210814233404](Image/QQ截图20210814233404.png)

```
白色：表示普通文件
蓝色：表示目录
绿色：表示可执行文件
红色：表示压缩文件
浅蓝色：链接文件
红色闪烁：表示链接的文件有问题
黄色：表示设备文件
灰色：表示其他文件
```

### 文件属性

**前面讲过，Linux系统是一个稳定、安全的多用户系统。Linux系统对不同的用户访问同一文件（包括目录文件）的权限做了不同的规定。**

我们可以使用 `ll` 或者 `ls –l` 命令来显示一个文件的属性以及文件所属的用户和组，如：

![QQ截图20210814172210](Image/QQ截图20210814172210.png)

每个文件的属性由左边第一部分的10个字符来确定（如下图）：

![vqwergbvbv](Image/vqwergbvbv.webp)

第一个字符代表目录、文件或链接文件等等：

- [ d ]代表目录；
- [ - ]代表文件；
- [ l ]代表链接文档 ( link file )，同时会显示指向的文件；
- [ b ]代表装置文件里面的可供储存的接口设备 ( 可随机存取装置 )；
- [ c ]代表装置文件里面的串行端口设备，例如键盘、鼠标 ( 一次性读取装置 )；

后面九个字符中，每三个字符为一组，且固定为『rwx』组合：

- [ r ]代表可读(read)；
- [ w ]代表可写(write)；
- [ x ]代表可执行(execute)；
- [ - ]代表没有该权限；
- 第1、4、7位表示读权限，用"r"字符表示，没有读权限，用"-"字符表示；
- 第2、5、8位表示写权限，用"w"字符表示，没有写权限，用"-"字符表示；
- 第3、6、9位表示执行权限，用"x"字符表示，没有执行权限，用"-"字符表示；

后面九个字符中，每三个字符为一组，代表不同的属主、属组、其他用户：

- 第1-3位确定属主（该文件的所有者）拥有该文件的权限；
- 第4-6位确定属组（所有者的同组用户）拥有该文件的权限；
- 第7-9位确定其他用户拥有该文件的权限；

**在Linux系统中，用户是按组分类的，一个用户属于一个或多个组。**

**每个文件都有一个特定的所有者，也就是对该文件具有所有权的用户，文件所有者以外的用户又可以分为"文件所有者的同组用户"和"其他用户"。**因此，Linux系统按文件所有者、文件所有者同组用户和其他用户来规定了不同的文件访问权限。

### 属性更改

更改文件属主 - **chown**

- `-R`：递归更改文件属主，更改某个目录文件的属主时，该目录下的所有文件的属主都会更改。

```
chown [–R] 属主名 文件名

# 只有管理员可以改变文件的所有者，所有者必须是存在的用户
chown root /tmp/a.file：将a文件的所有者改为root（不管是谁创建的）
```

更改文件属组 - **chgrp**

- `-R`：递归更改文件属组，更改某个目录文件的属组时，该目录下的所有文件的属组都会更改。

```
chgrp [-R] 属组名 文件名

# 只有管理员可以改变文件的所属组，所有者必须是存在的所属组
chgrp brother /tmp/a.file：将a文件的所属组更改为brother（不管是谁创建的）
```

更改文件权限 - **chmod**

- `-R`：递归更改文件权限，更改某个目录文件的权限时，该目录下的所有文件的权限都会更改。

```
chmod [-R] 数字/字符 文件或目录
```

目前最常用的就是通过数字更改文件的权限，权限数字对应关系：

```
读 —— r —— 4    写 —— w —— 2    执行 —— x —— 1  无权限 —— - —— 0

权限数字相加：
--- —— 0    --x —— 1    -w- —— 2    -wx —— 3
r-- —— 4    r-x —— 5    rw- —— 6    rwx —— 7

三个权限字符为一组：
--------- —— 000
r-x-wxrwx —— 567
...
rw-rw-rw- —— 666
rwxrwxrwx —— 777
```

![QQ截图20210815011653](Image/QQ截图20210815011653.png)

虽然改变了tmp1文件夹权限，但因为没有加上参数R，tmp1文件夹下的文件和文件夹的权限保持不变。

![QQ截图20210815012015](Image/QQ截图20210815012015.png)

另一种修改文件权限的方式就是通过字符进行修改：

```
chmod u+x Japan.list：给Japan.list文件的u（所有者）加x（执行权限）
chmod g+w Japan.list：给Japan.list文件的g（所属组）加w（写权限）
chmod o-r Japan.list：给Japan.list文件的o（其他人）减r（读权限）
chomd g=rwx Japan.list：给Japan.list文件的g（所属组）设置rwx（所有权限）
```

?> `umask -S`：显示创建文件夹的默认权限rwxr-xr-x

!> 注意：更改文件的权限只能是文件的所有者（文件创建者）或者是root（超级管理员）。

## 文件内容

### 内容新增

内容新增 - **echo**

- `-e`：支持反斜线控制的字符转换（具体参见表 1）
- `-n`：取消输出后行末的换行符号（内容输出后不换行）

| 控制字符 | 作 用                                                        |
| -------- | ------------------------------------------------------------ |
| \\       | 输出\本身                                                    |
| \a       | 输出警告音                                                   |
| \b       | 退格键，也就是向左删除键                                     |
| \c       | 取消输出行末的换行符。和“-n”选项一致                         |
| \e       | Esc键                                                        |
| \f       | 换页符                                                       |
| \n       | 换行符                                                       |
| \r       | 回车键                                                       |
| \t       | 制表符，也就是Tab键                                          |
| \v       | 垂直制表符                                                   |
| \Onnn    | 按照八进制 ASCII 码表输出字符。其中 0 为数字 0，nnn 是三位八进制数 |
| \xhh     | 按照十六进制 ASCH 码表输出字符。其中 hh 是两位十六进制数     |

![QQ截图202108211632281](Image/QQ截图202108211632281.png)

### 内容查看

Linux中有许多查看文件内容的命令，根据使用场景选择合适的命令：

从第一行开始显示文件内容 - **cat**

- `-n`：列印出行号，连同空白行也会有行号。

![QQ截图20210819005639](Image/QQ截图20210819005639.png)

自带行号从第一行开始显示文件内容 - **nl**

![QQ截图20210819005837](Image/QQ截图20210819005837.png)

分页显示文件内容 - **more**

- 空格键或F键，向下翻页；Enter键下翻一行；q键退出

![QQ截图20210819010256](Image/QQ截图20210819010256.png)

分页显示文件内容 - **less**

- 上下键上下翻一行；PageUp键向上翻页；PageDown键向下翻页；q键退出

![QQ截图20210819011105](Image/QQ截图20210819011105.png)

查看文件内容开始几行 - **head**

- `-n`：后面接数字，代表显示几行的意思！

![QQ截图20210819011315](Image/QQ截图20210819011315.png)

查看文件内容结尾几行 - **tail**

- `-n`：后面接数字，代表显示几行的意思！

![QQ截图20210819011446](Image/QQ截图20210819011446.png)

### 内容查找

使用在 `less` 命令里面查找字符串 - **/字符串**或**\?字符串**

- “/字符串”代表查找顺序从上到下；“?字符串”代表查找顺序从下到上
- n键，查找下一个字符串；N键，查找上一个字符串

![QQ截图20210819012322](Image/QQ截图20210819012322.png)

